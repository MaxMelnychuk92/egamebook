ACTION: $perform_necromancy_elsewhere
COMMAND: skills >> necromancy

// Keep this in sync with RaiseDead.helpMessage.
HINT: Raising the dead will make them fight for me. I do not know in advance which corpse will rise. I cannot do this if I am already followed by an undead. My powers are not strong enough to hold two unliving minds.

PREREQUISITES:
!(c.world.currentSituation as RoomRoamingSituation).monstersAlive
&&
!c.playerRoom.isSynthetic
&&
c.playerRoom.isOnMap
&&
!storyNecromanyHasPrecedence(c)

REPEATABLE: $TRUE

COMPLETE_SUCCESS_PROBABILITY:
// Keep in sync with FightSituation's RaiseDead.getSuccessChance.
final c = ApplicabilityContext(a, sim, w);
if (isFollowedByAnUndead(c, a)) {
    return ReasonedSuccessChance.sureFailure;
}
return const ReasonedSuccessChance<void>(0.6);

REROLL_RESOURCE: $SANITY

COMPLETE_SUCCESS_DESCRIPTION:
[[CODE]]
raiseDead(c);
[[ENDCODE]]

FAILURE_BEGINNING_DESCRIPTION:
// Keep in sync with FightSituation's RaiseDead.applyFailure.
I perform the necromantic incantation but I fail. Nothing happens. [[IF isFollowedByAnUndead(c, a)]]My powers are not strong enough to hold two unliving minds, and I already have an undead follower.[[ENDIF]]
