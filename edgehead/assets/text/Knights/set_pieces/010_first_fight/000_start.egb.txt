// APPROACH: $start FROM $start_tester_build
// COMMAND: Set piece >> from the start of the game

APPROACH: $start FROM $pre_start_book
COMMAND: $IMPLICIT


// ---
ROOM: $start

FIRST_DESCRIPTION:
[[CODE]]
// Use the ink
w.pushSituation(InkSituation.initialized(
    w.randomInt(),
    "start_ink_ink",
));
[[ENDCODE]]

// ---
ACTION: $start_ink
FOR_LOCATION: $start_bogus_location
COMMAND: N/A

INK:
Here I am in the ancient ruins of San Francisco. After a month long journey, I have finally reached my destination. My brother is here, somewhere.


* I am a young woman >> with curly black hair >> and a large debt.

[[CODE]]
c.recordCharacterChoice(0, 0, 0);
[[ENDCODE]]

* I am a young woman >> with curly black hair >> and a wooden stump instead of the left foot.

[[CODE]]
c.recordCharacterChoice(0, 0, 1);
[[ENDCODE]]

* I am a young woman >> with curly black hair >> and asthma.

[[CODE]]
c.recordCharacterChoice(0, 0, 2);
[[ENDCODE]]

* I am a young woman >> with wavy brown hair >> and a large debt.

[[CODE]]
c.recordCharacterChoice(0, 1, 0);
[[ENDCODE]]

* I am a young woman >> with wavy brown hair >> and a wooden stump instead of the left foot.

[[CODE]]
c.recordCharacterChoice(0, 1, 1);
[[ENDCODE]]

* I am a young woman >> with wavy brown hair >> and asthma.

[[CODE]]
c.recordCharacterChoice(0, 1, 2);
[[ENDCODE]]

* I am a young woman >> with long blond hair >> and a large debt.

[[CODE]]
c.recordCharacterChoice(0, 2, 0);
[[ENDCODE]]

* I am a young woman >> with long blond hair >> and a wooden stump instead of the left foot.

[[CODE]]
c.recordCharacterChoice(0, 2, 1);
[[ENDCODE]]

* I am a young woman >> with long blond hair >> and asthma.

[[CODE]]
c.recordCharacterChoice(0, 2, 2);
[[ENDCODE]]

* I am a young man >> with curly black hair >> and a large debt.

[[CODE]]
c.recordCharacterChoice(1, 0, 0);
[[ENDCODE]]

* I am a young man >> with curly black hair >> and a wooden stump instead of the left foot.

[[CODE]]
c.recordCharacterChoice(1, 0, 1);
[[ENDCODE]]

* I am a young man >> with curly black hair >> and asthma.

[[CODE]]
c.recordCharacterChoice(1, 0, 2);
[[ENDCODE]]

* I am a young man >> with wavy brown hair >> and a large debt.

[[CODE]]
c.recordCharacterChoice(1, 1, 0);
[[ENDCODE]]

* I am a young man >> with wavy brown hair >> and a wooden stump instead of the left foot.

[[CODE]]
c.recordCharacterChoice(1, 1, 1);
[[ENDCODE]]

* I am a young man >> with wavy brown hair >> and asthma.

[[CODE]]
c.recordCharacterChoice(1, 1, 2);
[[ENDCODE]]

* I am a young man >> with short blond hair >> and a large debt.

[[CODE]]
c.recordCharacterChoice(1, 2, 0);
[[ENDCODE]]

* I am a young man >> with short blond hair >> and a wooden stump instead of the left foot.

[[CODE]]
c.recordCharacterChoice(1, 2, 1);
[[ENDCODE]]

* I am a young man >> with short blond hair >> and asthma.

[[CODE]]
c.recordCharacterChoice(1, 2, 2);
[[ENDCODE]]

-


I am also a necromancer. I can raise the dead, although not very well yet.

I am here with Tamara, the deserter. She is the sword of my little expedition. It is unwise for a young necromancer to be traveling on [[IF c.playerIsMale]]his[[ELSE]]her[[ENDIF]] own.

Tamara has just finished telling me, for the hundredth time, what a stupid idea it is for me to come here. I tell her there's nothing to be worried about. I tell her the tales about goblins and orcs in the woods of San Francisco are exaggerated.

Which, of course, is immediately refuted by what happens next.

[ Image of a ferocious goblin ]

A goblin, death-hunger in his eyes, steps out of hiding, directly in front of us. I look around to see if there's more but no. He is alone. What gives the predator such confidence?

* Run

    Tamara seems pleased with this course of action at first. But the agile goblin is faster in the overgrowth. [[IF c.playerHasWoodenFoot]]My wooden stump doesn't help.[[ENDIF]] A few heartbeats later, he's almost upon us.

    He slashes Tamara's leg and she goes down. There is no more running now. [[IF c.playerHasAsthma]]I wheeze and cough. The damn asthma.[[ENDIF]] But I am able to pick up a solid branch from the ground and I have the initiative now.

    [[CODE]]
    // Make Tamara fall and lose initiative.
    w.updateActorById(
        tamaraId,
        (b) => b
        ..pose = Pose.onGround
        ..initiative = 0
        ..inventory.add(tamarasDagger));
    // TODO: Add the cut to Tamara's anatomy
    // Make goblin also lose initiative.
    w.updateActorById(firstGoblinId, (b) => b.initiative = 10);
    // Give branch to player.
    w.updateActorById(playerId, (b) => b.inventory.equip(startBranch, a.anatomy));
    [[ENDCODE]]

    The goblin growls like a wolf, standing above Tamara. She's had time to draw her mercenary sword but not much else. The goblin <>

* Attack

    "I escape war only to be dragged into *this* mess?" Tamara says through gritted teeth. But she moves forward, pointing her mercenary sword at the goblin. With her off hand, she hands me her dagger. "You'll need it, [young sir]."

    [[CODE]]
    w.updateActorById(playerId, (b) => b.inventory.add(tamarasDagger));
    w.updateActorById(firstGoblinId, (b) => b.initiative = 0);
    [[ENDCODE]]

    The goblin is out of the brush and ready to fight. He's gnashing his teeth and growls like a wolf. He <>

* Wait

    Tamara nods. She points her mercenary sword at the goblin but doesn't move. "Take my dagger, [young sir]," she tells me and moves her hip a little, to indicate where it's strapped.

    * * Take the dagger.

        [[CODE]]
        w.updateActorById(playerId, (b) => b.inventory.equip(tamarasDagger, a.anatomy));
        [[ENDCODE]]

        I take the dagger and point it in the direction of the goblin. The hilt is thick, and the weapon feels heavy but balanced. Before I know it, the goblin attacks. As he runs towards us, he <>

    * * Take a rock from the ground instead.

        [[CODE]]
        w.updateActorById(tamaraId, (b) => b.inventory.add(tamarasDagger));
        w.updateActorById(playerId, (b) => b.inventory.equip(rockFromMeadow, a.anatomy));
        [[ENDCODE]]

        I pick up a moldy rock that lies right next to my {left|right} foot. It's hard and heavy in my palm. As soon as I straighten up, the goblin attacks. As he runs towards us, he <>

-

<> taps his thigh with the blunt side of a rusty sword, grinning.
